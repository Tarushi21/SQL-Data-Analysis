--  What are the details of all cars purchased in the year 2022?

SELECT c.*
FROM cars c
JOIN sales s ON s.car_id = c.car_id
WHERE YEAR(s.purchase_date) = '2022'
ORDER BY car_id ASC;

--  What is the total number of cars sold by each salesperson?

SELECT sp.name AS SALESPERSON_NAME, COUNT(s.car_id) AS TOTAl_CARS
FROM sales s
JOIN salespersons sp ON s.salesman_id = sp.salesman_id
GROUP BY 1;

-- What is the total revenue generated by each salesperson?

SELECT sp.name AS SALESPERSON_NAME, SUM(c.cost_$)
FROM salespersons sp
JOIN sales s ON s.salesman_id = sp.salesman_id
JOIN cars c ON s.car_id = c.car_id
GROUP BY 1; 

-- What are the details of the cars sold by each salesperson?

SELECT sp.name AS SALESPERSON_NAME, c.*
FROM salespersons sp
JOIN sales s ON s.salesman_id = sp.salesman_id
JOIN cars c ON s.car_id = c.car_id
ORDER BY name, car_id; 

--  What is the total revenue generated by each car type?

SELECT type AS CAR_TYPE, sum(cost_$) AS TOTAL_REVENUE
FROM cars c
JOIN sales s ON s.car_id = c.car_id
GROUP BY 1;

-- What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

SELECT sp.name as salesperson_name, c.*
FROM salespersons sp
JOIN sales s ON s.salesman_id = sp.salesman_id
JOIN cars c ON s.car_id = c.car_id 
WHERE YEAR(s.purchase_date) = '2021'
AND sp.name = 'Emily Wong';

-- What is the total revenue generated by the sales of hatchback cars?

SELECT c.style AS CAR, SUM(c.cost_$) as TOTAL_REVENUE
FROM cars c
JOIN sales s ON s.car_id = c.car_id 
WHERE style = 'hatchback';

-- What is the total revenue generated by the sales of SUV cars in the year 2022?

SELECT c.style AS CAR, SUM(c.cost_$) as TOTAL_REVENUE
FROM cars c
JOIN sales s ON s.car_id = c.car_id 
WHERE style = 'SUV'
AND YEAR(purchase_date) = '2022';

-- What is the name and city of the salesperson who sold the most number of cars in the year 2023?

SELECT name, city FROM 
(SELECT sp.name, sp.city, COUNT(s.car_id) AS TOTAL_CARS
FROM sales s
JOIN salespersons sp ON s.salesman_id = sp.salesman_id
WHERE YEAR(s.purchase_date) = '2023'
GROUP BY 1,2
ORDER BY 3 DESC
LIMIT 1) AS TOTAL_CARS_SOLD;

-- What is the name and age of the salesperson who generated the highest revenue in the year 2022?

SELECT name, age FROM 
(SELECT sp.name, sp.age, SUM(c.cost_$) AS TOTAL_CARS
FROM sales s
JOIN salespersons sp ON s.salesman_id = sp.salesman_id
JOIN cars c ON s.car_id = c.car_id
WHERE YEAR(s.purchase_date) = '2022'
GROUP BY 1,2
ORDER BY 3 DESC
LIMIT 1) AS TOTAL_REVENUE_GENERATED;
