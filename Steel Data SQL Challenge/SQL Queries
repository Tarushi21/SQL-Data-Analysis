--What are the details of all cars purchased in the year 2022?

SELECT DISTINCT c.*, s.*
FROM CARS c 
JOIN SALES s ON c.car_id=s.car_id
WHERE YEAR(purchase_date)='2022';

--. What is the total number of cars sold by each salesperson?

SELECT s.SALESMAN_ID, sale.name, COUNT(SALES_ID) AS TOTAL_SALES 
FROM SALES s
JOIN SALESPERSON sale ON s.SALESMAN_ID= sale.SALESMAN_ID
group by 1,2
ORDER BY TOTAL_SALES DESC;

--What is the total revenue generated by each salesperson?

SELECT s.SALESMAN_ID, sp.name, SUM(cost_$) AS TOTAL_REVENUE
FROM cars c
JOIN SALES s ON c.car_id= s.car_id
JOIN SALESPERSON sp ON s.SALESMAN_ID= sp.SALESMAN_ID
GROUP BY 1,2;

--. What are the details of the cars sold by each salesperson?

SELECT s.SALESMAN_ID, sp.name, c.*
FROM cars c
JOIN SALES s ON c.car_id= s.car_id
JOIN SALESPERSON sp ON s.SALESMAN_ID= sp.SALESMAN_ID
ORDER BY 1;

--What is the total revenue generated by each car type?

SELECT c.car_id, c.make, c.type, c.style, SUM(cost_$) AS TOTAL_REVENUE
FROM cars c
JOIN SALES s ON c.car_id=s.car_id
GROUP BY 1,2,3,4
ORDER BY TOTAL_REVENUE DESC;

--What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong

SELECT c.*, sp.name, s.purchase_date AS year_of_purchase
FROM CARS c
JOIN SALES s ON c.car_id=s.car_id
JOIN SALESPERSON sp ON sp.salesman_id=s.salesman_id
WHERE YEAR(s.purchase_date)= '2021' AND sp.name='EMILY WONG';

--What is the total revenue generated by the sales of hatchback cars?

SELECT c.style, SUM(cost_$)
FROM cars c
JOIN SALES s ON c.car_id=s.car_id
WHERE c.style='HATCHBACK'
GROUP BY 1;

--What is the total revenue generated by the sales of SUV cars in the year 2022?

SELECT c.style, SUM(cost_$)
FROM cars c
JOIN SALES s ON c.car_id=s.car_id
WHERE c.style='SUV' AND YEAR(s.purchase_date)='2022'
GROUP BY 1;

--What is the name and city of the salesperson who sold the most number of cars in the year 2023?

SELECT sp.name, sp.city, COUNT(SALES_ID) AS TOTAL_SALES
FROM SALESPERSON sp
JOIN SALES s ON sp.salesman_id=s.salesman_id
WHERE YEAR(s.purchase_date)='2023'
GROUP BY 1,2
ORDER BY TOTAL_SALES DESC
LIMIT 1;

--What is the name and age of the salesperson who generated the highest revenue in the year 2022?

SELECT sp.name, sp.age, SUM(cost_$) AS TOTAL_REVENUE
FROM SALESPERSON sp
JOIN SALES s ON sp.salesman_id=s.salesman_id
JOIN CARS c on c.car_id=s.car_id
WHERE YEAR(s.purchase_date)='2022'
GROUP BY 1,2
ORDER BY TOTAL_REVENUE DESC
LIMIT 1;

