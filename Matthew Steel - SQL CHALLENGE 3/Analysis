--What are the names of all the countries in the country table?

SELECT COUNTRY_NAME FROM COUNTRY;

--What is the total number of customers in the customers table?

SELECT COUNT(CUSTOMER_ID) AS TOTAL_CUSTOMER FROM CUSTOMERS;

--What is the average age of customers who can receive marketing emails (can_email is set to 'yes')?

SELECT ROUND(AVG(AGE),1) AS AVG_AGE 
FROM CUSTOMERS
WHERE CAN_EMAIL = 'yes';

--How many orders were made by customers aged 30 or older?

SELECT COUNT(ORDER_ID) AS TOTAL_ORDERS
FROM ORDERS o
JOIN CUSTOMERS c ON c.customer_id = o.customer_id
WHERE c.age >=30;

--What is the total revenue generated by each product category?

SELECT  p.CATEGORY, SUM(p.PRICE) AS TOTAL_REVENUE
FROM PRODUCTS p
JOIN BASKETS b ON p.product_id = b.product_id
GROUP BY 1;

--What is the average price of products in the 'food' category?

SELECT CATEGORY, ROUND(AVG(PRICE),2) AS AVG_PRICE
FROM PRODUCTS
WHERE CATEGORY = 'food'
GROUP BY 1;

--How many orders were made in each sales channel (sales_channel column) in the orders table?

SELECT SALES_CHANNEL, COUNT(ORDER_ID) AS NUMBER_OF_ORDERS
FROM ORDERS
GROUP BY 1;

--What is the date of the latest order made by a customer who can receive marketing emails?

SELECT MAX(DATE_SHOP) as latest_date
FROM ORDERS o
JOIN CUSTOMERS c ON c.customer_id = o.customer_id
WHERE CAN_EMAIL = 'yes';

--What is the name of the country with the highest number of orders?

SELECT COUNTRY_NAME, COUNT(ORDER_ID) AS TOTAL_ORDERS
FROM ORDERS o 
JOIN COUNTRY c ON o.country_id = c.country_id
GROUP BY 1
ORDER BY 2 DESC
LIMIT 1;

--What is the average age of customers who made orders in the 'vitamins' product category?

SELECT p.CATEGORY, ROUND(AVG(c.AGE),2) AS AVG_AGE
FROM CUSTOMERS c
JOIN ORDERS o ON c.customer_id = o.customer_id
JOIN BASKETS b ON b.order_id = o.order_id
JOIN PRODUCTS p ON b.product_id = p.product_id
WHERE p.CATEGORY = 'vitamins'
GROUP BY 1;
